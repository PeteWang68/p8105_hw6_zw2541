---
title: "p8105_hw6_zw2541"
author: "Zixu_Wang"
date: "11/22/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Problem 1

### Read and clean the data

```{r}
homicides = read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(
    city_state = str_c(city, state, sep = ", "),
    solved = as.factor(ifelse(disposition %in% c("Closed without arrest", "Open/No arrest"), 0, 1))) %>% 
  filter(!(city_state %in% c("Dallas, TX", "Phoenix, AZ", "Kansas City, MO", "Tulsa, AL"))) %>% 
  mutate(
    victim_race = ifelse(victim_race == "White", "White", "non-White"),
    victim_race = factor(victim_race, levels = c("White", "non-White")),
    victim_age = as.numeric(victim_age))
```

### Fit a logistic regression model

```{r}
ml_baltimore =
  homicides %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(solved ~ victim_sex + victim_race + victim_age, family = binomial, data = .)

ml_baltimore %>% 
  broom::tidy(conf.int = TRUE) %>% 
  mutate(odds_ratio = exp(estimate),
         conf_low = exp(conf.low),
         conf_high = exp(conf.high)) %>% 
  select(term, odds_ratio, conf_low, conf_high) %>% 
  filter(term == "victim_racenon-White") %>% 
  knitr::kable(digits = 3)
```

The estimate of the adjusted odds ratio for solving homicides comparing non-white victims to white victims is 0.441 (keeping all other variables fixed), and the confidence interval is (0.312, 0.620).
